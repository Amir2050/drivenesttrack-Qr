<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DriveNestTrack VIN Scanner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 0; padding: 0; }
    #reader { width: 100vw; max-width: 400px; margin: auto; }
    #result { margin-top: 20px; font-size: 18px; }
  </style>
  <script src="https://unpkg.com/html5-qrcode@2.3.7/minified/html5-qrcode.min.js"></script>
</head>
<body>
  <h2>DriveNestTrack VIN Scanner</h2>
  <div id="reader"></div>
  <div id="result"></div>

  <script>
    const resultContainer = document.getElementById('result');
    function onScanSuccess(decodedText, decodedResult) {
      // Stop scanning after first successful scan
      html5QrcodeScanner.clear().then(_ => {
        const vin = decodedText.trim();
        resultContainer.innerHTML = `<b>VIN Detected:</b> ${vin}<br><a href="https://vpic.nhtsa.dot.gov/decoder/Decoder?vin=${vin}" target="_blank" rel="noopener">View Vehicle Info</a>`;
        // Optionally redirect automatically:
        // window.location.href = `https://vpic.nhtsa.dot.gov/decoder/Decoder?vin=${vin}`;
      }).catch(error => {
        console.error('Failed to clear html5QrcodeScanner', error);
      });
    }

    const config = { fps: 10, qrbox: 250 };
    const html5QrcodeScanner = new Html5Qrcode("reader");
    html5QrcodeScanner.start(
      { facingMode: "environment" },
      config,
      onScanSuccess
    ).catch(err => {
      resultContainer.innerHTML = `Error starting camera: ${err}`;
    });
  </script>
</body>
</html>

